/*global Backbone, _ */(function(a){var b=a.View;a.View=b.extend({_configure:function(a){b.prototype._configure.apply(this,arguments),this._configureStates(this.states||[],a)},_configureStates:function(a,b){this.state={};for(var c=0,d;d=a[c];c++)this.state[d]=b[d]===!0},states:[],getState:function(a){return this.state[a]},setState:function(a,b){if(this.state[a]===b)return this;this.state[a]=b,this.$el.state&&this.$el.state(a,b),this.trigger("change:state:"+a,this,b),this.trigger("change:state",this,a,b)},toggleState:function(a,b){return b!==undefined?this.setState(a,b):this.setState(a,!this.getState(a))},onState:function(a,b,c,d){var e=this.getState(a);return e===b&&c.call(d,this,e),this.on("change:state:"+a,function(a,e){e===b&&c.apply(d,arguments)}),this},onceState:function(a,b,c,d){var e=this.getState(a);if(e===b)return c.call(d,this,e),this;var f=this,g=function(e,f){e.off("change:state:"+a,g,d),f===b&&c.apply(d,arguments)};return this.on("change:state:"+a,g,d),this}})})(Backbone);