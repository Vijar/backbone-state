//     Backbone State 0.0.1
//
//     by Ian Storm Taylor
//     https://github.com/ianstormtaylor/backbone-state
(function(a,b){if(typeof define=="function"&&define.amd)define(function(){return b(a)});else{if(a.Backbone===undefined)throw new Error("Couldn't find Backbone");a.Backbone.mixin||(a.Backbone.mixin={}),a.Backbone.mixin.state=b(a)}})(this,function(a){var b=function(){var a=this.prototype._configure;this.prototype._previousAttributes||this.prototype._prepareModel?this.prototype._configure=function(b,c){a.apply(this,arguments),this._configureStates(this.states||[],c)}:this.prototype._configure=function(b){a.apply(this,arguments),this._configureStates(this.states||[],b)},this.prototype._configureStates=function(a,b){this.state={};for(var c=0,d;d=a[c];c++)this.state[d]=b[d]===!0},this.prototype.getState=function(a){return this.state[a]},this.prototype.setState=function(a,b){if(this.state[a]===b)return this;this.state[a]=b,this.$el.state&&this.$el.state(a,b),this.trigger("change:state:"+a,this,b),this.trigger("change:state",this,a,b)},this.prototype.toggleState=function(a,b){return b!==undefined?this.setState(a,b):this.setState(a,!this.getState(a))},this.prototype.onState=function(a,b,c,d){var e=this.getState(a);return e===b&&c.call(d,this,e),this.on("change:state:"+a,function(a,e){e===b&&c.apply(d,arguments)}),this},this.prototype.onceState=function(a,b,c,d){var e=this.getState(a);if(e===b)return c.call(d,this,e),this;var f=this,g=function(e,f){e.off("change:state:"+a,g,d),f===b&&c.apply(d,arguments)};return this.on("change:state:"+a,g,d),this}};return b});